2013-07-12  Bruce Korb  <bkorb@gnu.org>

	bump version to 5.18

2013-07-11  Bruce Korb  <bkorb@gnu.org>

	handle flag options in embedded operands
	single character option "flags" were not correctly understood.
	Also, when looking for ambiguous option names, do not check
	the "doc" options -- their name strings are NULL.

	* autoopts/find.c (opt_ambiguities): do not compare ambiguous option name
	  against a NULL pointer (documentation name).

	* autoopts/load.c (optionMakePath): break path name canonicalization code
	  (optionLoadLine): save and restore processing flags and turn off
	  OPTPROC_ERRSTOP while processing a line.

	* autoopts/test/main.test: fix embedded flag option test.

	* autoopts/tpl/agtexi-cmd.tpl: if sedding the autogen name does not find
	  you the columns program name, then fall back to "which columns".
	* autoopts/tpl/cmd-doc.tlib: likewise
	* autoopts/tpl/def2pot.tpl: likewise
	* autoopts/tpl/getopt.tpl: likewise
	* autoopts/tpl/options.tpl: likewise
	* autoopts/tpl/str2init.tlib: likewise
	* autoopts/tpl/usage.tlib: likewise

2013-07-09  Bruce Korb  <bkorb@gnu.org>

	edit out testing stuff during install
	* autoopts/install-hook.sh: autoopts/tpl/options.tpl got dropped
	* compat/pathfind.c (pathfind): add a fallback path.

2013-07-07  Bruce Korb  <bkorb@gnu.org>

	replace more echoes with printfs
	Some echo commands like to process backslash escapes.
	* autoopts/tpl/mdoc2man.sh: fix the problem
	* autoopts/test/doc.test: adjust the test results
	* autoopts/test/keyword.test: likewise

2013-07-06  Bruce Korb  <bkorb@gnu.org>

	more doc tweaks

	improve "main shell-process" doc

2013-07-05  Bruce Korb  <bkorb@gnu.org>

	fix up fixup expression

2013-07-05  Bruce Korb  <bkorb@gnu.org>

	funnel all libopts exiting to option_exits
	Make certain that upon exit, stdout has an exit command
	whenever it is needed and not otherwise.

	Also, extract *all* global variable definitions to autoopts.h,
	guarded by "AUTOOPTS_INTERNAL".

2013-07-05  Bruce Korb  <bkorb@gnu.org>

	paged usage cleanup
	It, too, needs substantial work to cope with shell scripts reading
	standard input.

	* autoopts/pgusage.c (open_tmp_usage): extracted new proc
	  (mk_pager_cmd): likewise
	  (optionPagedUsage): remove some cluttered code and make sure
	  stray "exit 0" commands do not appear in the usage text and also
	  print usage text to stderr when necessary.

	* autoopts/ao-strs.def: new strings for that code.

2013-07-05  Bruce Korb  <bkorb@gnu.org>

	Mulligan: emit exit command for shell processing
	When libopts exits for any reason, the shell must be told to exit.

	* autoopts/proc-state.def: new option processing state: shell-output
	  marks the options as requiring shell status to stdout and all
	  other text to stderr.
	* autoopts/test/defs.in: remove from usage any line starting with
	  "exit" and then a digit.
	* autoopts/test/getopt.test: specify shell-process type main().
	* autoopts/test/shell.test: likewise, and adjust usage text
	* autoopts/tpl/optcode.tlib: add new SHELL_OUTPUT process flag
	* autoopts/tpl/optlib.tlib: main proc attribute validation
	* autoopts/tpl/optmain.tlib: do not fiddle stdout.  Use new flag.
	* autoopts/tpl/usage.tlib: use unspecified main procedure type.
	* autoopts/usage.c (optionUsage): print exit code in presence of
	  OPTPROC_SHELL_OUTPUT flag, and then redirect output to stderr.
	* */opts.def: eliminame NLS code.  Nothing is translatable.
	* doc/autogen-intro.texi: belated cleanup

2013-07-04  Bruce Korb  <bkorb@gnu.org>

	use test guards only for test-main
	Inserting these guards are a dinkleberry from a decade ago.
	Insert the guards IFF "test-main" is specified in the
	option definition file.  If "main" is specified, then
	the code is unconditionally compiled in.

	* autoopts/tpl/optmain.tlib:
	  "guarded-test-main" is a boolean computed in optlib.tlib.
	  emit the test main guards IFF this is #t (true).
	* autoopts/tpl/optcode.tlib:
	  Do not emit a define for the test main guard.
	* autoopts/test/argument.test: adjust
	* doc/auto-opts.tlib: remove debug code

2013-07-03  Bruce Korb  <bkorb@gnu.org>

	optionPutShell must write usage to stderr
	The recommended usage for option parsing programs that emit text
	to be evaluated by a shell must always write usage text to stderr.

	* agen5/autogen.c (done_check): fix warning
	* autoopts/test/defs.in
	  send xtrace output to fd 8 and capture stderr when getting help.
	  optionPutShell() programs now emit usage to stderr.

	* autoopts/tpl/optcode.tlib: unistd now required for optionPutShell
	* autoopts/tpl/optlib.tlib: rework main proc variables
	* autoopts/tpl/optmain.tlib: use these variables to decide how to
	  produce the doUsageOption code.

	* doc/auto-opts.tlib: improve debug aids
	* doc/mk-agen-texi.sh: emit all the log files on error

	* autoopts/test/handler.test: adjustments
	* autoopts/test/immediate.test: likewise
	* autoopts/test/shell.test: likewise
	* autoopts/test/stdopts.test: likewise

2013-07-02  Bruce Korb  <bkorb@gnu.org>

	allow suffixes on exe name
	* autoopts/tpl/agtexi-cmd.tpl:
	  The templates must use the columns program from the same directory
	  as autogen itself.  Use echo/sed to replace "autogen" with "columns".
	* autoopts/tpl/agtexi-file.tpl: likewise
	* autoopts/tpl/cmd-doc.tlib: likewise
	* autoopts/tpl/def2pot.tpl: likewise
	* autoopts/tpl/options.tpl: likewise
	* autoopts/tpl/str2init.tlib: likewise
	* autoopts/tpl/usage.tlib: likewise

	* agen5/opts.def: separate autoopts options from autogen ones.
	* autoopts/test/vendor.test: adjust test
	* config/libopts.def: shorten comment

2013-06-29  Bruce Korb  <bkorb@gnu.org>

	out-of-memory handling
	* autoopts/tpl/opthead.tlib: capture the exit code named "no-mem" or "nomem".
	  (nomem_err): emit new function when "die-code" is specified and a no-mem
	  exit code is also specified.
	* doc/autogen-texi.txt: document this.

2013-05-31  Bruce Korb  <bkorb@gnu.org>

	handle Solaris
	* agen5/ag-text.def (EMIT_INVAL_PORT): format used by long value
	  (ULONG_FMT): it is unsigned, not signed.  Rename.
	  (RESOLVE_SCM_NUMBER): use "ULONG_FMT" instead
	* agen5/funcDef.c (build_defs): use ULONG_FMT instead
	* agen5/funcEval.c (scm2display): use ULONG_FMT instead
	* templates and scripts everywhere: cope with Solaris' "tr" program
	  and use 'printf' when "\f" sequences need to be emitted literally.

2013-05-18  Bruce Korb  <bkorb@gnu.org>

	increase timeout for usage.test

	set release version to 5.17.4

	clean here string
	* agen5/defLex.c (build_here_str): allow backslash to escape any horizontal
	  white space character, not just a tab.
	* autoopts/tpl/cmd-doc.tlib (mk-description): blank lines within a description
	  need to cause a blank line on output.  Replace any residual empty lines
	  with ".sp".

2013-05-11  Bruce Korb  <bkorb@gnu.org>

	restore newline

	fix --no-load-opts on man page

	restore missing nl to auto-opts.tlib

	update NEWS

	quote process stored option args
	* agen5/agCgi.c (loadCgi): silence warning error triggered by ignoring
	  fdopen of STDERR_FILENO.
	* agen5/agDep.c (start_dep_file): use open fd with fdopen
	* agen5/cgi-fsm.c: update with current template
	* autoopts/load.c (assemble_arg_val): If the arg value for
	  optionLoadLine() is quoted, then quote process it
	* config/confmacs.tlib: for lib macros, enclose the value caching
	  in the disablement guard, too.
	* getdefs/test/defs: rendered redundant.  Remove.
	* autoopts/tpl/agtexi-cmd.tpl: do not interfere with previously
	  existing .texi files.  Also refactor some code so that config file
	  enabled, but no config file defined, programs read correctly.
	* autoopts/tpl/cmd-doc.tlib: skip the blather about saving config files
	  when "disable-save" is active.
	* autogen-texi.txt: break up the autoopts quick example
	* doc/auto-opts.tlib: some @subsections go here, too.
	* ChangeLog: last update.  A one year change log will be derived
	  hereafter.

2013-05-06  Bruce Korb  <bkorb@gnu.org>

	set membership cleanup
	* autoopts/enum.c: (set_memb_names) omit superfluous "none" at start of
	  membership list.
	  (check_membership_start): new function broken out of optionSetMembers
	  (find_member_bit): likewise
	* autoopts/putshell.c: (print_membership): adjust for fixes
	* autoopts/test/cfg-edit.test: likewise
	* autoopts/test/keyword.test: likewise
	* autoopts/tpl/optlib.tlib: add a macro for invoking the member list
	* autoopts/save.c: (prt_set_arg): remove redundant test
	* doc/autogen-texi.txt: (arg-type set membership) clarify exactly how
	  the first character of a set membership string is treated.
	* autoopts/stack.c: (optionUnstackArg): fix Windows code
	* autoopts/tpl/optcode.tlib: simplify expression
	* autoopts/tpl/texi2man.sh: handle @sp texi command
	* autoopts/tpl/texi2mdoc.sh: likewise
	* autoopts/autogen.map: add "-" and "!" to "set-separator".
	* config/libopts.def: add check for gettext function
	* agen5/opts.def: copyright date
	* autoopts/tpl/agtexi-cmd.tpl: fix check-for-no-homerc attribute
	* autoopts/tpl/cmd-doc.tlib: omit clause when the only homerc string
	  is empty.

2013-04-14  Bruce Korb  <bkorb@gnu.org>

	fix typo

2013-04-13  Bruce Korb  <bkorb@gnu.org>

	libopts does not require sys/mman.h

	Remove scribble code to its own file
	* agen5/scmStrings.c: remove scribbling code to scribble.c and move
	  ag_scm2zchars() to expGuile.c.
	* agen5/scribble.c: new -- extracted scribble code
	* agen5/scribble.h: new
	* agen5/Makefile.am: accommodate these changes
	* agen5/*: replace 'ag_scribble' with just 'scribble'.
	* agen5/expGuile.c (ag_scm2zchars): moved here from scmStrings.c
	* agen5/test/error.test: strip off all trailing Guile messages from
	  test output -- they change all the time.
	* autoopts/tpl/cmd-doc.tlib: clarify behavior of --save-opts option
	* autoopts/tpl/agtexi-cmd.tpl: likewise

2013-03-31  Bruce Korb  <bkorb@gnu.org>

	make sure test cleanup has "msg" defined

	set release version

	cleanup cleanup (finishing)
	* everywhere: file start and end markers.
	* add-on/cright-update: updating it.
	* autoopts/tpl/lgplv2.lic: new license file
	* autoopts/genshell.def: use it
	* agen5/autogen.c (done_check): use "exit" not "_exit".
	  (cleanup_and_abort): likewise
	* autoopts/streqvcmp.c (streqvcmp): do not transform character
	  before having tested for the same character.
	  (strneqvcmp): likewise
	* agen5/mk-stamps.sh: run code generation in parallel
	* agen5/test/Makefile.am: use install-defs.sh to make "defs".
	* agen5/test/error.test: ban the "Failing Guile command" message
	* agen5/tpParse.c (print_indentation): warning patrol
	* autoopts/test/defs.in: added uniformity for sedding into place
	* config/bootstrap.local: remove some exceptionalism.
	* config/install-defs.sh: script for installing "defs" files (new)
	* getdefs/test/Makefile.am: use the "defs" file so the tests can
	  run in parallel
	* getdefs/test/*.test: use the "defs" from autoopts testing,
	  tweaking the sample test output as needed.
	* autoopts/usage.c: guard inclusion of <libintl.h> with
	  defined(ENABLE_NLS) && defined(HAVE_LIBINTL_H)

	lgplv2 license
	* lgplv2.lic: new license file for genshell:
	  the GNU Lesser General Public License, version 2.0 or later
	* automake cleanups
	* debugging needs have been disentangled from installed use of
	  gettext.
	* agen5/autogen.c: use "exit" not "_exit".
	* autoopts/streqvcmp.c: do not transform character
	  before having tested for the same character.

2013-03-10  Bruce Korb  <bkorb@gnu.org>

	cleanup test dir usage

	kill thumper task on completion

2013-03-09  Bruce Korb  <bkorb@gnu.org>

	file name marker cleanups

	update cright-update

2013-02-24  Bruce Korb  <bkorb@gnu.org>

	add enable-nls

2013-02-23  Bruce Korb  <bkorb@gnu.org>

	constification cleanup

	deoxyfication
	Accept "addtogroup" attribute in several templates.
	Use it in the various definition files.
	Add grouping markups for each program and autoopts.
	Also deal with a lack of gperf(1GNU) gracefully.

2013-02-17  Bruce Korb  <bkorb@gnu.org>

	mark deprecated options
	Also correctly locate TRANSLATORS: commment and use an index to
	scan the AUTOOPTS_USAGE string so we do not lose our place.

2013-02-15  Bruce Korb  <bkorb@gnu.org>

	fix up capitalization
	also update the NEWS and adjust tests for new capitalization.

2013-02-09  Bruce Korb  <bkorb@gnu.org>

	trim trailing whitespace
	Fix the dne and licensing functions to not leave behind
	trailing whitespace.  Adjustments needed in
	autogen.h, expFormat.c, expString.c, functions.tpl and the
	format.test test.

2013-02-03  Bruce Korb  <bkorb@gnu.org>

	do not catch SIGPROF
	* agen5/autogen.c (cleanup_and_abort): call _exit() immediately if
	  autogen is still in the initialization phase.
	  (setup_signals): exempt SIGPROF from capture.
	* agen5/autogen.h: doxy-comment some variables
	* agen5/opts.def (signal): reassign the exit code to 128.
	* agen5/tpLoad.c (load_macs): remove unneeded parameter.
	* agen5/tpParse.c (print_indentation) new
	  (print_ag_defs): also new
	  (parse_tpl): remove debug printing code to new procedures

	NEWS

2013-02-02  Bruce Korb  <bkorb@gnu.org>

	rework definition directives
	* agen5/defDirect.c (processDirective): Correctly handle bad directives
	  Basically, rework the thing.
	* agen5/directive.tpl: remove
	* agen5/ag-text.def: remove obsolete strings
	* agen5/mk-stamps.sh (top_builddir): add a default for it
	  (make_directive): use a dispatching enumeration instead of a
	  special purpose template.

	allow extra texi gen time

	release version stamp

	Correctly handle bad directives

2013-02-02  Bruce Korb  <bkorb@gnu.org>

	fix up i18n
	* autoopts/alias.c (too_many_occurrences): new function for handling
	  an option that occurs too many times.
	  (optionAlias): use it
	* autoopts/autoopts.c (handle_opt): also use it
	* autoopts/bootstrap.dir (usage-txt.tpl): do not install
	* autoopts/ao-strs.def: add all immutable strings, remove translatable
	  ones
	* autoopts/makeshell.c (fserr_warn): new function to emit message
	  about an error found in errno
	  (fserr_exit): call fserr_warn() and exit failure
	* autoopts/restore.c (optionSaveState): AGALOC aborts on failure,
	  do not check result for NULL
	* autoopts/usage.c (AOFLAG_TABLE): make module global
	  (parse_usage_flags): broken out of set_usage_flags().
	  Add code to handle "compute" usage so that the usage code ignores
	  the full usage and short usage strings.
	* autoopts/usage-txt.def: remove all untranslatable strings and
	  mark libopts messages differently from usage construction strings.
	  Ensure all error messages include the program name and are made
	  consistent.
	* autoopts/*.c: adjust for these changes
	* autoopts/usage-txt.tpl: moved from tpl subdirectory.  Removed
	  accommodation for untranslatable strings
	* autoopts/test/cfg-edit.test: adjust
	* autoopts/test/enums.test: adjust
	* autoopts/test/keyword.test: adjust

	* autoopts/options_h.tpl (opt_usage_t): enumeration of AutoOpts
	  supported options.  The "reserved" field of each option structure
	  is now initialized with this value.
	* autoopts/tpl/optcode.tlib: use the enumerated values
	* autoopts/usage.c (ao_bug): new function to print a message
	  and exit EX_SOFTWARE on a libopts bug
	  (print_offer_usage) new function to show misusers of an interface how
	  to request help when usage details are not printed.
	* autoopts/usage-txt.def: adjust texts
	* doc/autogen-texi.txt: describe some of the new workings.
	* autoopts/autoopts.c (optionProcess): use ao_bug()
	* autoopts/find.c (get_opt_arg_may): likewise
	  (get_opt_arg): simplify code

2013-01-21  Bruce Korb  <bkorb@gnu.org>

	prefer apostraphy quotes in messages to back quotes

2013-01-19  Bruce Korb  <bkorb@gnu.org>

	Add news for new features

	update the documentation

	fix prototypes

	new methods for C strings
	* agen5/agShell.c (shell_cmd): add tracing info on server restart
	* agen5/expState.c (ag_scm_get): add trace info on failure
	* autoopts/init.c (validate_struct): use "field_ct" as the
	  "has it been translated?" indicator
	* autoopts/putshell.c (string_size): migrated from expString.c
	  (optionQuoteString): a revamp of makeString from expString.c
	* autoopts/usage.c (print_one_paragraph) new support function
	  (optionPrintParagraphs): print a long string a paragraph at a time
	* autoopts/ao-strs.def: new strings for optionQuoteString
	* agen5/expString.c: remove string_size and makeString functions
	  (ag_scm_mk_gettextable): new - emit phony functions that xgettext
	  can use for string extraction.
	  (ag_scm_kr_string): use new optionQuoteString function
	  (ag_scm_c_string): likewise
	* agen5/ag-text.def: add and remove strings for changes above
	* autoopts/tpl/getopt.tpl: fix test environment issues
	* autoopts/tpl/optcode.tlib: emit a bogus translation string fn.
	* autoopts/tpl/options.tpl: set up test environment for finding
	  the correct columns executable.
	* autoopts/tpl/optlib.tlib: removed from here
	* autoopts/tpl/usage.tlib: copy needed here, too
	* compat/windows-config.h: mark when Windows env has no inttypes.h
	* autoopts/tpl/str2enum.tpl: do not include inttypes.h when missing
	* autoopts/test/defs.in: improve use of temp directories.
	  Maybe these can be done in parallel soon...
	* autoopts/test/*.test: adjust for changes
	* config/bootstrap: omit check for internal "missing" program
	* config/missing: deleted

	checksum update + Windows build tweaking

2013-01-04  Bruce Korb  <bkorb@gnu.org>

	fix issues
	error out on duplicate entry indexes.
	enhance tracing for FOR macro.
	polish documentation templates

	Happy 2013

	update cright-update for 2013

2013-01-01  Bruce Korb  <bkorb@gnu.org>

	update copyright year

2012-12-31  Bruce Korb  <bkorb@gnu.org>

	Update Harlan-s mdoc2texi script. handle the new doc-sub (substitution) stanzas.

2012-12-30  Bruce Korb  <bkorb@gnu.org>

	deprecate some unused options

	polish docs

	integrate section 5 man page documentation

2012-12-29  Bruce Korb  <bkorb@gnu.org>

	man page section 5 stuff + warning nitpicks

2012-12-28  Bruce Korb  <bkorb@gnu.org>

	picky warning wrapup

	picky warning cleanup

	define CLexe in the enumeration templates, too.

2012-12-27  Bruce Korb  <bkorb@gnu.org>

	release polish

	fix misspelling of name

	undo combining append-description into mk-description

2012-12-21  Bruce Korb  <bkorb@gnu.org>

	Apply texi2whatever conversions for various doc sections

	fix up nit-picky casts in prep for picky warnings

2012-12-16  Bruce Korb  <bkorb@gnu.org>

	polishing

	shell option required arguments
	Support has now been added to emitted shell script code that
	will verify that required options have been specified.

	fix up NULL result handling

	resort the autogen strings

2012-12-02  Bruce Korb  <bkorb@gnu.org>

	Verify the libguile version with the compiled one.
	If the library we link to is not the same major/minor version
	we expected at config time, we are hosed.  Die with a meaningful msg.

2012-12-01  Bruce Korb  <bkorb@gnu.org>

	Cope with Guile fiddling LD_LIBRARY_PATH.
	Also, allow --with-guile-ver to set the Guile version without
	bothering to test for the value.

2012-11-18  Bruce Korb  <bkorb@gnu.org>

	guard against not being able to find a license file.

2012-11-03  Bruce Korb  <bkorb@gnu.org>

	doc tweak

	binary search for keywords
	search for names in sorted lists with a binary search.
	Also, allow for multiple dispatcher functions.

2012-10-29  Bruce Korb  <bkorb@gnu.org>

	doc polishing

2012-10-28  Bruce Korb  <bkorb@gnu.org>

	more test and doc cleanups

	doc some of this stuff

	polishing

2012-10-27  Bruce Korb  <bkorb@gnu.org>

	update NEWS in prep for release

	binary search for keywords
	search for names in sorted lists with a binary search.

2012-10-21  Bruce Korb  <bkorb@gnu.org>

	bump minor ver + doc FOR macro better

2012-10-10  Bruce Korb  <bkorb@gnu.org>

	off by one

	remove unneeded stuff

2012-10-09  Bruce Korb  <bkorb@gnu.org>

	add found-for? predicate function

2012-10-07  Bruce Korb  <bkorb@gnu.org>

	wrap up str2mask template

2012-10-06  Bruce Korb  <bkorb@gnu.org>

	short circuit move on unchanged name

	str2enum: replacement for crufty shell script

2012-10-01  Bruce Korb  <bkorb@gnu.org>

	dump timestamps and whitespace

2012-09-30  Bruce Korb  <bkorb@gnu.org>

	use str2enum template and pitch shell script.
	Shell script was clunky, hard to use and caused problems on another project.
	The template is _much_ better.

2012-09-21  Bruce Korb  <bkorb@gnu.org>

	Microsoft compiler is still C89 and not C99.  Cope.

2012-09-20  Bruce Korb  <bkorb@gnu.org>

	null out the correce environment variable

2012-09-15  Bruce Korb  <bkorb@gnu.org>

	fix LD_LIBRARY_PATH
	Recent Guile libraries provide a value that breaks things.
	Remove it for all such Guile libraries.

2012-09-05  Bruce Korb  <bkorb@gnu.org>

	remove untranslatable strings from translation table

2012-09-04  Bruce Korb  <bkorb@gnu.org>

	doc updates from Harlan + init code separation

2012-09-03  Bruce Korb  <bkorb@gnu.org>

	Rolling .pot file into libopts tear-off is pointless.

2012-09-01  Bruce Korb  <bkorb@gnu.org>

	adjust configuration/bootstrap code

	allow user supplied code for AutoOpts coded functions

	distribute the usage-txt.pot file, too.

	indent some text

	rename camel cased variables

2012-08-11  Bruce Korb  <bkorb@gnu.org>

	supply top_srcdir for TEXINFO_TEX

2012-08-11  Bruce Korb  <bkorb@gnu.org>

	fix up i18n stuff
	Omnibus patch:

	* autoopts/tpl/agtexi-cmd.tpl: Fix up "help" option name in texi doc.
	* autoopts/ao-strs.def: remove stray newline
	* autoopts/autogen.map: add lead option line skip characters
	* autoopts/load.c (loadOptionLine): use it
	* autoopts/test/shell.test: adjust
	* autoopts/tpl/opthead.tlib (gettext): ensure it is declared
	* autoopts/tpl/optmain.tlib (fserr_fmt): not always static.
	* autoopts/tpl/strings.tpl: justify and sort the define list
	* compat/compat.h (strsignal) check that HAVE_RAW_DECL_STRSIGNAL
	  is also not declared before declaring strsignal.
	* config/confmacs.tlib: AC_TRY_RUN is obsolete
	* config/libopts.def: AC_ERROR is obsolete
	* doc/autogen-texi.txt (config-header): doc it
	* fix up "help" option reference in texi
	* print stderr output only on error
	* Coverity cleanups
	* RPM build fixes
